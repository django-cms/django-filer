{% load i18n filer_admin_tags staticfiles %}

{% spaceless %}
    <div class="dz-preview dz-file-preview hidden js-dropzone-template">
        <span class="filerFile">
            <div class="dz-thumbnail"><img class="quiet" data-dz-thumbnail></div>
            <span data-dz-name class="dz-name"></span>
            <img class="filerClearer" src="{% static admin_icon_delete %}" width="10" height="10" alt="{% trans 'Clear' %}" title="{% trans 'Clear' %}"
                 data-dz-remove data-no-icon-file="{% static 'filer/icon/nofile_48x48.png' %}">
            <div class="dz-progress js-dropzone-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>
        </span>
    </div>

    <div class="js-dropzone dropzone" data-url="{% url 'admin:filer-ajax_upload' %}">
        <div class="dz-default dz-message js-dropzone-message{% if object %} hidden{% endif %}">
            <span class="icon fa fa-arrow-down"></span><span>{% trans "or drop your file here" %}</span>
        </div>

        <span class="filerFile js-file-selector">
            {% if object %}
                {% if object.icons.32 %}
                    <a href="{{ object.url }}" target="_blank"><img class="thumbnail_img" src="{{ object.icons.48 }}" alt="{{ object.label }}"></a>
                    &nbsp;<span class="description_text">{{ object.label }}</span>
                {% else %}
                    <img class="thumbnail_img" src="{% static 'filer/icons/missingfile_48x48.png' %}" alt="{% trans 'file missing' %}">
                    &nbsp;<span class="description_text">{% trans 'file missing' %}</span>
                {% endif %}
            {% else %}
                <img src="{% static 'filer/icons/nofile_48x48.png' %}" class="thumbnail_img quiet" alt="{% trans 'no file selected' %}">
                &nbsp;<span class="description_text"></span>
            {% endif %}

            <a href="{{ lookup_url }}" class="js-related-lookup related-lookup {% if object %}hidden{% endif %} lookup" id="{{ id }}_lookup"
               title="{% trans 'Lookup' %}" {% if LTE_DJANGO_1_7 %}onclick="return showRelatedObjectLookupPopup(this);"{% endif %}>
                {% trans 'Add File' %}
            </a>

            <img class="filerClearer {% if not object %}hidden{% endif %}" src="{% static admin_icon_delete %}"
                 width="10" height="10" alt="{% trans 'Clear' %}" title="{% trans 'Clear' %}"
                 data-no-icon-file="{% static 'filer/icons/nofile_48x48.png' %}">

            <br>

            {{ hidden_input }}
            <script type="text/javascript" id="{{id}}_javascript">
                django.jQuery(document).ready(function(){
                    var plus = django.jQuery('#add_{{ id }}');
                    if (plus.length){
                        plus.remove();
                    }
                    // Delete this javascript once loaded to avoid the "add new" link duplicates it
                    django.jQuery('#{{id}}_javascript').remove();
                });
            </script>
        </span>
    </div>
{% endspaceless %}

<link rel="stylesheet" type="text/css" href="{% static 'filer/css/admin_filer.css' %}">
<script src="{% static 'filer/js/libs/dropzone.min.js' %}"></script>
<script src="{% static 'filer/js/addons/dropzone.init.js' %}"></script>
