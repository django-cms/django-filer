// messagelist appears after saving a file
ul.messagelist {
	position: relative;
	z-index: 1;
	&.fade-out {
		opacity: 1;
		animation: fade-out-animate 1s linear 4s 1;
	}

	@keyframes fade-out-animate {
		100% {
			opacity: 0;
		}
	}
}

.content {
	position: relative;
}

$trash-background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgb(248, 248, 248) 10px, rgb(248, 248, 248) 20px);
$follow-folder-border: 2px dashed var(--border-color);
$copied-inode-border: 2px dashed rgb(48, 164, 0);
$active-rectangle: rgb(210, 210, 112);

#content {
	padding: 0;
	h1 {
		margin: 10px 20px;
	}
}

#content-react {
	position: absolute;
	right: 0;
	left: 0;
	bottom: 0;
	padding: 0;
	user-select: none;

	&.folder {
		top: 0;
	}
	&.file {
		top: 36px;
	}

	nav[role="menubar"] {
		margin: 4px 0;

		ul {
			list-style: none;
			box-sizing: border-box;
			display: flex;
			flex-wrap: wrap;
			margin: 0 15px;
			padding: 0;

			li {
				display: list-item;
				list-style: none;
				padding: 0;
				cursor: pointer;
				border-radius: 4px;
				width: 32px;
				height: 32px;

				&:hover:not(.disabled):not(.search-field) {
					background-color: var(--selected-bg);
				}

				&.active {
					background-color: var(--selected-row);
				}

				&.disabled {
					opacity: 0.5;
					cursor: not-allowed;
				}

				&.erase svg {
					color: var(--delete-button-bg);
				}

				&.search-field {
					display: inline-flex;
					width: calc(100% - 400px);
					max-width: 400px;

					> input {
						width: calc(100% - 48px);
						min-width: 100px;
						height: 100%;
						display: block;
						margin: 0;
						padding: 2px 8px;
						border: 1px solid lightgrey;
						border-right: none;
						border-top-left-radius: 5px;
						border-bottom-left-radius: 5px;

						&:focus-visible {
							outline: none;
						}

						& + div {
							border: 1px solid lightgrey;
							border-left: none;
							border-top-right-radius: 5px;
							border-bottom-right-radius: 5px;
							padding: 0 5px 0 10px;
							display: flex;

							span:hover {
								background-color: lightgrey;
							}

							.search-icon {
								svg {
									transform: scale(0.8);
								}
							}

							.search-realm {
								[role="combobox"] {
									li:nth-child(2) {
										padding-bottom: 4px;
										border-bottom: 1px solid lightgrey;
										margin-bottom: 4px;
									}
								}
							}
						}
					}

					&:has(> input:focus-visible) {
						box-shadow: rgb(50, 150, 250) 0 0 5px;
					}
				}

				&.sorting-dropdown {
					margin-left: auto;
					margin-right: auto;
					width: auto;
				}

				&.extra-menu [role="combobox"] {
					right: 0;
					margin-inline-end: inherit;
					> li:nth-child(5):not(:last-child) {
						padding-bottom: 4px;
						border-bottom: 1px solid var(--border-color);
						margin-bottom: 4px;
					}
				}

				svg {
					display: inline-block;
					width: 30px;
					height: 30px;
					margin: 1px;
				}
			}

			[aria-haspopup="true"]:has([role="combobox"]) {
				position: relative;
				display: flex;
				&.with-caret::after {
					content: " ";
					align-self: center;
					border: 5px solid transparent;
					border-top-color: black;
					margin-top: 10px;
				}
			}

			[role="combobox"] {
				position: absolute;
				z-index: 1;
				background-color: white;
				top: 100%;
				left: -250px;
				right:-250px;
				margin-inline: auto;
				border: 1px solid var(--border-color);
				border-radius: 4px;
				box-shadow: 0 0 8px var(--border-color);
				display: flex;
				flex-direction: column;
				width: max-content;
				padding-top: 3px;
				padding-bottom: 3px;
				padding-inline-start: 3px;
				padding-inline-end: 3px;

				&[aria-expanded="false"] {
					display: none;
				}

				li {
					padding: 0 2rem 0 0.5rem;
					width: auto;
					cursor: pointer;
					display: flex;
					line-height: 32px;
					font-size: 16px;

					&.active::after {
						content: "âœ”";
						position: absolute;
						right: 10px;
					}
				}

				svg {
					color: grey;
				}
				span {
					margin-left: 40px;
				}
				svg + span {
					margin-left: 10px;
				}
			}
		}
	}

	ul.folder-tabs {
		display: flex;
		flex-wrap: wrap;
		margin: 10px 0 0 0;
		padding: 0 15px;
		border-bottom: 1px solid var(--border-color);

		li {
			display: list-item;
			list-style: none;
			margin: -5px 1px -1px 1px;
			padding: 6px 14px;
			font-size: 16px;
			font-weight: bold;
			border: 1px solid var(--border-color);
			border-top-left-radius: 4px;
			border-top-right-radius: 4px;
			border-bottom: 1px solid ghostwhite;
			background-color: white;

			&.active, &.current {
				background-color: ghostwhite;
			}
			&:not(.active) {
				cursor: pointer;
				border-bottom: 1px solid var(--border-color);
			}
			&.drag-over {
				color: var(--selected-row);
				background-color: var(--button-hover-bg);
			}
			&.trash {
				background-image: $trash-background;
				background-color: transparent;
				background-attachment: fixed;
				margin-left: auto;
			}

			span {
				cursor: pointer;
				margin-left: 10px;
				:hover {
					background-color: lightgrey;
				}
				> svg {
					height: 16px;
					width: 16px;
					margin: -2px 0;
				}
			}

			> svg, > a > svg {
				display: inline-block;
				width: 24px;
				height: 24px;
				margin: -6px 0;
			}
		}
	}

	.work-area {
		width: 100%;
		height: calc(100% - 75px);
		overflow: hidden;
		display: flex;
		flex-wrap: nowrap;
		flex-direction: row-reverse;
		justify-content: flex-start;
		align-items: stretch;

		&:not(:has(.inode-list.trash)) {
			background-color: ghostwhite;
		}

		.column-droppable {
			&.dragging {
				// while dragging, extend the droppable area to the full height of the work-area
				position: absolute;
				inset: 0;
			}

			&.drag-over {
				background-color: var(--primary);

				ul.inode-list > li:nth-child(even) {
					background-color: inherit;
				}
			}
		}

		ul.inode-list {
			> li {
				&.dragging .inode, &.cutted .inode {
					outline: 1px dashed grey;
					filter: grayscale(100%);
					opacity: 0.35;
				}

				&.copied .inode {
					border: $copied-inode-border;

					&::after {
						content: " ";
						position: absolute;
						bottom: 5px;
						right: 5px;
						width: 32px;
						height: 32px;
						background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(48, 164, 0)"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z"></path></svg>');
						background-repeat: no-repeat;
					}
				}
			}

			&.trash > li:nth-child(n):not(.selected) {
				background-color: transparent;
			}
		}

		.file-uploader {
			width: 100%;
		}

		.scrollable-area {
			position: relative;
			width: 100%;
			height: 100%;
			overflow-x: hidden;
			overflow-y: scroll;
			overflow-anchor: none;
		}

		.trimmed-column {
			width: 20px;
			display: flex;
		}

		.selectable-area {
			position: absolute;
			width: 100%;
			min-height: 100%;

			.selection-rectangle {
				position: absolute;
				background:
					linear-gradient(90deg, $active-rectangle 66%, transparent 0) repeat-x,
					linear-gradient(90deg, $active-rectangle 66%, transparent 0) repeat-x,
					linear-gradient(0deg, $active-rectangle 66%, transparent 0) repeat-y,
					linear-gradient(0deg, $active-rectangle 66%, transparent 0) repeat-y;
				background-size: 10px 2px, 10px 2px, 2px 10px, 2px 10px;
				background-position: 0 0, 0 100%, 0 0, 100% 0;
				animation: border-animate 800ms infinite linear;
			}

			@keyframes border-animate {
				100% {
					background-position: 10px 0, -10px 100%, 0 -10px, 100% 10px;
				}
			}

			&:has(.trash) {
				background-image: $trash-background;
				background-color: transparent;
				background-attachment: fixed;
			}
		}
	}

	input[type="file"] {
		width: 0 !important;
		height: 0 !important;
		position: absolute;
		bottom: 0;
		padding: 0;
	}

	.progress-overlay {
		position: absolute;
		inset: 0;
		z-index: 1;
		background-color: rgba(255, 255, 255, 0.75);
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;

		.progress-indicator {
			width: calc(100% - 100px);
			max-width: 500px;
			background-color: rgba(50, 150, 250, 0.5);
			border: 3px solid rgb(50, 150, 250);
			padding: 20px;

			p {
				font-weight: bold;
				font-size: 20px;
			}

			.progress-bar {
				padding: 0;

				li {
					display: flex;
					justify-content: space-between;
					span {
						text-overflow: ellipsis;
					}
					progress {
						width: 50%;
					}
				}
			}
		}
	}

	ul.inode-list {
		margin: 0;

		> li {
			display: block;
			list-style: none;
			padding: 5px;
			border: 1px solid transparent;
			cursor: pointer;
			font-size: 15px;
			line-height: 18px;

			&:hover {
				filter: brightness(1.125);
			}

			&.selected {
				box-shadow: inset  0 0 0.5rem var(--accent);
				outline: 1px dotted var(--accent);
				background-color: rgb(from var(--selected-row) r g b / 50%);
			}

			&.disabled {
				opacity: 0.5;
				cursor: not-allowed;
			}

			&.status {
				font-size: 18px;
				font-weight: bold;
				line-height: 50px;
				color: var(--body-quiet-color);
				padding-left: 2em;
			}

			[aria-roledescription="draggable"]:focus-visible {
				outline: none;
			}

			.inode {
				height: 100%;
				width: 100%;

				&.drag-over {
					color: var(--selected-row);
					background-color: var(--primary);
					outline: 1px solid var(--link-hover-color);
				}

				.inode-name {
					padding: 5px;
					border-radius: 3px;

					&:focus-visible {
						background-color: var(--body-bg);
						outline: 1px solid var(--link-selected-fg);
						outline-offset: -1px;
						box-shadow: inset var(--link-selected-fg) 0 0 10px;
					}
				}
			}
		}
	}

	.tiles ul.inode-list, .mosaic ul.inode-list {
		display: flex;
		padding: 15px;
		flex-wrap: wrap;
		flex-direction: row;
		align-content: flex-start;
		justify-content: flex-start;

		li .inode {
			box-sizing: border-box;

			div:has(> .figure-labels) {
				position: relative;
			}

			.figure-labels {
				position: absolute;
				float: left;
				text-align: right;
				overflow: hidden;
			}

			figure {
				height: 100%;
				display: flex;
				flex-direction: column;
				flex-wrap: nowrap;
				justify-content: space-between;
				margin: 0;

				img {
					width: 100%;
					border-radius: 5px;

					&:not([src$=".svg"]) {
						box-shadow: var(--border-color) 0 0 5px;
					}

					&[src$=".svg"] {
						transform: scale(85%);
					}
				}
				video {
					border-radius: 5px;
					box-shadow: var(--border-color) 0 0 5px;
				}

				figcaption {
					margin-top: 0.25rem;
					text-align: center;
					width: 100%;
					word-break: break-all;
				}
			}

			.inode-name {
				margin-top: 2px;
			}
		}
	}

	.tiles ul.inode-list {
		gap: 10px;

		li .inode .figure-labels {
			inset: 5px;
			span {
				width: 12px;
				height: 12px;
				display: inline-block;
				border-radius: 50%;
				margin-left: -4px;
			}
		}

		li:not(.status) {
			min-height: 250px;
			width: 190px;
		}
	}

	.mosaic ul.inode-list {
		gap: 5px;

		li .inode .figure-labels {
			inset: -2px 2px auto 2px;

			span {
				width: 8px;
				height: 8px;
				display: inline-block;
				border-radius: 50%;
				margin-left: -3px;
			}
		}

		li:not(.status) {
			min-height: 120px;
			width: 70px;
		}
	}


	.list ul.inode-list, .columns ul.inode-list {
		display: block;
		padding: 0;

		> li {
			width: 100%;
			box-sizing: border-box;

			&:nth-child(even):not(.selected) {
				background-color: var(--body-bg);
			}

			&:last-child {
				border-bottom: 1px solid var(--border-color);
			}

			.inode {
				display: grid;
				gap: 2px;
				align-items: center;

				div {
					&:has(img, video) {
						display: flex;
						justify-content: center;

						img, div:has(>video) {
							height: 60px;
							align-self: center;
						}
					}

					&:has(> .inode-name) {
						overflow: hidden;
						padding-right: 1rem;
					}
				}

				.figure-labels {
					display: inline-flex;
					width: 15px;
					height: 60px;
					overflow: hidden;
					flex-direction: column;
					align-items: end;
					padding-top: 4px;

					span {
						width: 10px;
						height: 10px;
						display: block;
						border-radius: 50%;
						margin-top: -3px;
					}

				}
			}
		}
	}

	.list ul.inode-list {
		> li {

			&.header {
				height: auto;
				font-weight: bold;
				border-bottom: 1px solid var(--border-color);
			}

			.inode {
				grid-template-columns: 90px 1fr 1fr 1fr;
				@media (min-width: 992px) and (max-width: 1199.98px) {
					grid-template-columns: 90px 1fr 1fr 1fr 1fr 1fr;
				}
				@media (min-width: 1200px) {
					grid-template-columns: 90px 1fr 1fr 1fr 1fr 1fr 1fr;
				}

				div {
					&:nth-child(6) {
						display: none;
						@media (min-width: 1200px) {
							display: block;
						}
					}
					&:nth-child(7) {
						display: none;
						@media (min-width: 992px) {
							display: block;
						}
					}
				}
			}
		}
	}

	.columns ul.inode-list {
		margin-top: 0.25rem;

		>li:has(>div>div.parent) {
			border-top: $follow-folder-border;
			border-left: $follow-folder-border;
			border-bottom: $follow-folder-border;
			border-top-left-radius: 5px;
			border-bottom-left-radius: 5px;
		}

		.inode {
			grid-template-columns: 90px 1fr;
			position: relative;
			box-sizing: border-box;

			&.parent::after {
				position: absolute;
				right: 0;
				content: " ";
				width: 32px;
				height: 32px;
				background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="rgb(192, 192, 192)"><path d="M13.1714 12.0007L8.22168 7.05093L9.63589 5.63672L15.9999 12.0007L9.63589 18.3646L8.22168 16.9504L13.1714 12.0007Z"></path></svg>');
				background-repeat: no-repeat;
			}
		}
	}

	.download-droppable, .discard-droppable {
		position: absolute;
		bottom: 0;
		width: 110px;
		height: 85px;
		overflow: hidden;

		&:not(.dragging) {
			visibility: hidden;
		}

		.quadrant {
			position: absolute;
			bottom: -75px;
			width: 200px;
			height: 150px;
			color: var(--button-fg);
			background-color: var(--button-bg);
			border: 3px solid var(--default-button-bg);
			border-radius: 50%;
			transform: scale(0);
			transition: transform 0.5s ease-in-out;

			svg {
				width: 40px;
				height: 40px;
				position: absolute;
				bottom: 80px;
			}
		}

		&.dragging .quadrant {
			transform: scale(1);
		}

		&.dragging.drag-over .quadrant {
			background-color: var(--default-button-bg);
			color: var(--selected-row);
		}
	}

	.download-droppable {
		left: 0;

		.quadrant {
			left: -100px;

			svg {
				left: 120px;
			}
		}
	}

	.discard-droppable {
		right: 0;

		.quadrant {
			right: -100px;

			svg {
				right: 120px;
			}
		}
	}

	.drag-overlay {
		ul.inode-list {
			opacity: 0.75;
			border: 1px dashed var(--body-quiet-color);
			overflow: hidden;

			> li {
				cursor: grabbing;
			}
		}
	}

	.detail-editor {
		padding: 0 20px 40px;

		input[readonly] {
			border: none;
			padding-left: 0;
			padding-right: 0;
			&:focus-visible {
				outline: none;
			}
		}
	}

	.file-details {
		width: 100%;

		img.editable {
			max-height: 500px;
		}
		img:not(.editable) {
			height: 150px;
		}

		div.button-group {
			margin-top: 10px;
			margin-bottom: 10px;
			display: flex;
			flex-wrap: wrap;
			button, a {
				display: block;
				appearance: none;
				border: none;
				font-weight: 400;
				border-radius: 4px;
				padding: 5px 15px;
				line-height: 25px;
				color: white;
				background: var(--default-button-bg);
				margin-right: 10px;
				margin-bottom: 10px;
				cursor: pointer;
				&:hover {
					background: var(--default-button-hover-bg);
				}

				svg {
					margin-right: 0.5rem;
					vertical-align: text-bottom;
					width: 20px;
				}
			}
		}

		.select-labels {
			flex-grow: 1;
			min-width: 800px;
		}
		.select-labels-value {
			border: 1px solid lightgrey;
			border-radius: 2px;
			box-sizing: border-box;
			display: flex;
			margin-right: 0.5rem;
			padding: 0.25rem;
		}
		.select-labels-option {
			padding: 0.5rem 1rem;
			&:hover {
				background-color: var(--selected-row);
			}
		}
		span.select-labels-dot {
			width: 12px;
			height: 12px;
			display: inline-block;
			border-radius: 50%;
			margin-left: 0.25rem;
			margin-right: 0.5rem;
		}
	}
}

@import 'node_modules/react-image-crop/src/ReactCrop.scss';
@import 'node_modules/react-h5-audio-player/src/styles.scss';
